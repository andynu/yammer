(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const e of s)if(e.type==="childList")for(const c of e.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function o(s){const e={};return s.integrity&&(e.integrity=s.integrity),s.referrerPolicy&&(e.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?e.credentials="include":s.crossOrigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function i(s){if(s.ep)return;s.ep=!0;const e=o(s);fetch(s.href,e)}})();function A(t,a=!1){return window.__TAURI_INTERNALS__.transformCallback(t,a)}async function y(t,a={},o){return window.__TAURI_INTERNALS__.invoke(t,a,o)}var E;(function(t){t.WINDOW_RESIZED="tauri://resize",t.WINDOW_MOVED="tauri://move",t.WINDOW_CLOSE_REQUESTED="tauri://close-requested",t.WINDOW_DESTROYED="tauri://destroyed",t.WINDOW_FOCUS="tauri://focus",t.WINDOW_BLUR="tauri://blur",t.WINDOW_SCALE_FACTOR_CHANGED="tauri://scale-change",t.WINDOW_THEME_CHANGED="tauri://theme-changed",t.WINDOW_CREATED="tauri://window-created",t.WEBVIEW_CREATED="tauri://webview-created",t.DRAG_ENTER="tauri://drag-enter",t.DRAG_OVER="tauri://drag-over",t.DRAG_DROP="tauri://drag-drop",t.DRAG_LEAVE="tauri://drag-leave"})(E||(E={}));async function I(t,a){window.__TAURI_EVENT_PLUGIN_INTERNALS__.unregisterListener(t,a),await y("plugin:event|unlisten",{event:t,eventId:a})}async function W(t,a,o){var i;const s=(i=void 0)!==null&&i!==void 0?i:{kind:"Any"};return y("plugin:event|listen",{event:t,target:s,handler:A(a)}).then(e=>async()=>I(t,e))}document.addEventListener("DOMContentLoaded",async()=>{console.log("Yammer app loaded");const t=document.querySelector(".status-indicator"),a=document.querySelector(".status-text"),o=document.querySelector(".transcript-text"),s=document.getElementById("waveform").getContext("2d");let e={status:"idle",transcript:"",isPartial:!1};const c=268,f=40,l=40,w=Math.floor(c/l),R=1;let p=new Array(l).fill(0);function m(){s.clearRect(0,0,c,f);for(let r=0;r<l;r++){const n=p[r],d=Math.max(2,n*f),u=r*w,_=(f-d)/2,g=Math.min(255,Math.floor(n*255+100));s.fillStyle=`rgb(${g}, ${Math.floor(g*.7)}, ${Math.floor(g*.3)})`,s.fillRect(u,_,w-R,d)}}function h(){t.className=`status-indicator ${e.status}`;const r={idle:"Ready",listening:"Listening...",processing:"Processing...",correcting:"Correcting...",done:"Done",error:"Error"};a.textContent=r[e.status]||"Ready",e.transcript?(o.textContent=e.transcript,o.classList.remove("placeholder"),e.isPartial?o.classList.add("partial"):o.classList.remove("partial")):(o.textContent="Press hotkey to start dictating...",o.classList.add("placeholder"),o.classList.remove("partial"))}await W("audio-samples",r=>{const n=r.payload;if(Array.isArray(n)&&n.length>0){const d=Math.floor(n.length/l);for(let u=0;u<l;u++){const _=u*d;p[u]=Math.abs(n[_]||0)}m()}}),setInterval(()=>{if(e.status!=="listening"){for(let r=0;r<l;r++)p[r]*=.85;m()}},50),window.setYammerState=r=>{e={...e,...r},h()},window.testWaveform=async()=>{try{await y("simulate_audio"),console.log("Simulated audio sent")}catch(r){console.error("Failed to simulate audio:",r)}},window.testStates=()=>{const r=[{status:"listening",transcript:"",isPartial:!1},{status:"processing",transcript:"This is a test...",isPartial:!0},{status:"correcting",transcript:"This is a test transcript",isPartial:!1},{status:"done",transcript:"This is a test transcript.",isPartial:!1},{status:"idle",transcript:"",isPartial:!1}];let n=0;const d=setInterval(()=>{window.setYammerState(r[n]),console.log("State:",r[n].status),n++,n>=r.length&&clearInterval(d)},2e3)},h(),m(),setTimeout(()=>{window.testWaveform(),setInterval(()=>window.testWaveform(),1e3)},1e3)});
